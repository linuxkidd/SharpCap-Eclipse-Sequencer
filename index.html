<!DOCTYPE html>

<html lang=”en”>
<head>
    <title>SharpCap Eclipse Sequence Creator</title>
    <meta charset="utf-8">
    <meta name="viewport" 
          content="width=device-width, initial-scale=1.0">
</head>
<style type="text/css">
    h1 {
        color: blue;
    }

    #headerDiv {
        margin-bottom: 1em;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-direction: row;
    }

    #bodyWrapper {
        max-width: 1000px;
        margin: auto;
    }

    #FlipDivTips, #FlipDivInstructions {
        display: none;
    }

    .headerBlock {
        background-color: lightskyblue;
        margin: 0;
        padding: 15px;
        border-bottom: 1px solid blue;
    }

    .goodInput {
        border: 2px solid #0f0;
        background: rgba(0,0,0,0);
    }

    .badInput {
        border: 2px solid #f00;
        background: rgba(0,0,0,0);
    }

    .disabledInput {
        border: 1px solid #000;
        background: rgba(0,0,0,0.3);
    }

    .code {
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        background: #eee;
        padding: 1px 3px;
    }

    div {
        display: flex;
        flex-direction: column;
    }

    table {
        border-collapse: collapse;
    }

    table td {
        padding: 3px;
    }

    ul.topMenu {
        list-style-type: none;
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: #666;
        margin-bottom: 15px;
    }

    ul.topMenu li {
      float: left;
      border-right: 1px solid #bbb;
    }

    ul.topMenu li a {
        display: block;
        color: white;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
    }

    ul.topMenu li a:hover {
      background-color: #111;
    }

    ul.topMenu li a.active {
        background-color: #04AA6D;
    }

    ol li {
        padding: 3px;
    }

    dl dt {
        font-weight: bold;
        font-size: 1.1em;
    }

    dl dd {
        padding: 3px;
    }

    .flipDiv {
        max-width: 80%;
    }

    .params {
        border: 1px solid;
    }

    .planDiv, .psPlanDiv {
        border: 1px solid;
        margin: 10px auto;
        min-width: 1000px;
        text-align: left;
    }

    .planTable {
        width: 100%;
    }

    .planTable td {
        border-bottom: 1px solid black;
        text-align: center;
    }

    textarea {
        margin-top: 15px;
        width: 70%;
    }

    input[type="number"] {
        text-align: right;
        max-width: 60px;
    }
    input[type="text"] {
        text-align: right;
        max-width: 100px;
    }
    .wideButton {
        width: 100%;
    }
</style>
 
<body>
    <div id="bodyWrapper">
        <h1>
          SharpCap Eclipse Sequence Creator
        </h1>
        <div id="headerDiv">
            <h3>Requires <a href="https://www.sharpcap.co.uk/">SharpCap Pro</a> version 4.1.11947 or newer!</h3>
            <input type="button" value="Optional: Download Powershell Script & Assets" id="psDownloadButton" style="max-width: 45%;" onClick="downloadPSScript();" />
        </div>
        <ul class="topMenu">
            <li><a id="MenuNotes" href="javascript://" onClick="toggleDiv(this);" class='active'>Notes</a></li>
            <li><a id="MenuInstructions" href="javascript://" onClick="toggleDiv(this);">Instructions</a></li>
            <li style="border-right: 0px;"><a href="javascript://" >&lt; - Click the active menu item to hide the content.</a></li>
        </ul>
        <div class="flipDiv" id="FlipDivNotes">
            <dl>
                <dt>What time?</dt>
                <dd>Times should be entered in local time of your observing site.</dd>
                <dd>You can get the local Eclilpse Event Times from <a href="https://www.timeanddate.com/eclipse/map/2024-april-8" target="_blank">Time and Date</a>.</dd>
                <dt>Lots of Data...</dt>
                <dd>I suggest adding <span class="code">{TargetName}</span> and <span class="code">{Exposure}</span> in the filename template in SharpCap Settings to make it easier to differentiate files after the eclipse.</dd>
                <dd>Example: <span class="code">{Date:S}\{TargetName}\{TargetName}_{Time}_{Exposure}</span></dd>
                <dt>Test, test test!</dt>
                <dd>Ahead of the eclipse, please test the operation and behavior of your hardware.</dd>
                <dt>Total Recall</dt>
                <dd>The full configuration is now saved to your local browser, in case you'd like to tweak your action plan in the future.</dd>
                <dd>The parameter encoded URL is put as a comment in the top of the generated sequence file, so you can use that for future collection plan tweaks.</dd>
                <dt>Baily's Beads into Totality</dt>
                <dd>If you'd like to capture the Baily's Beads Collection Plan into totality, you can do so by fudging the 'Full Begins' and/or 'Full Ends' times to be after totality begins/before totality ends.</dd>
                <dd>This may be useful since prediction of the exact moment of totality is not exact due to the shape of the Moon's surface.</dd>
            </dl>
        </div>
        <div class="flipDiv" id="FlipDivInstructions">
            <ol>
                <li>Go to <a href="https://www.timeanddate.com/eclipse/map/2024-april-8" target="_blank">Eclipse Map</a>.</li>
                <li>Zoom into your observation location and click to place the pin on the map.</li>
                <li>Note the <i>Partial</i> and <i>Full</i> <i>Begin</i> and <i>End</i> times provided on the left side of the map.</li>
                <li>Enter the observing site local times under <span class="code">Eclipse Times</span> below, in 24 hour, HH:MM:SS format.</li>
                <li>Adjust the <span class="code">Intervals</span> and <span class="code">Camera Settings</span> as desired below.<br />
                    <b>Notes:</b>
                    <ul>
                        <li><span class="code">Partial Eclipse Count</span> <b>(recommended)</b> generates evenly spaced collections based on partial eclipse percentage, starting 1 minutes into the eclipse.</li>
                        <li><span class="code">Partial Eclipse Interval</span> generates evenly space collections based on time alone, with no concern for even partial percentage.</li>
                        <li><b>The two cannot be used at the same time.</b></li>
                    </ul>
                </li>
                <li>Add and adjust the steps for each <span class="code">Collection Plan</span> section below.</li>
                <li>Click the <span class="code">Generate</span> button.</li>
                <li>A <span class="code">Generated Sequence</span> section will appear below.</li>
                <li>Use the <span class="code">Download SharpCap Sequence</span> button and save the sequence file.</li>
                <li>In SharpCap Pro version 4.1.11922.0 or newer:
                    <ul type="a">
                        <li>Connect to your camera and center the Sun in your camera's view.</li>
                        <li>Click the <span class="code">Sequencer</span> menu item</li>
                        <li>Then <span class="code">Run...</span></li>
                        <li>Pick the downloaded sequence file and click the <span class="code">Open</span> button.</li>
                    </ul>
                </li>
                <li>Monitor for an Alert sound, and banner at the top to Remove or Apply the Solar Filter around the time of Totality.</li>
            </ol>

            <h4><em>Optional:</em> Download the Powershell script and assets</h4>
            <ol>
                <li>Download Powershell script and assets zip archive</li>
                <li>Extract the zip archive to <span class="code">{SHARPCAP_INSTALL_FOLDER}\scripts\eclipse\</span> (.e.g. <span class="code">C:\Program Files\SharpCap 4.1 (64 bit)\scripts\eclipse\</span>)</li>
                <li>Generate a sequence</li>
                <li>Download the <span class="code">april-2024-solar-eclipse-config.ps1</span> file and save it to the same directory in step 3 - <span class="code">{SHARPCAP_INSTALL_FOLDER}\scripts\eclipse\</span> (.e.g. <span class="code">C:\Program Files\SharpCap 4.1 (64 bit)\scripts\eclipse\</span>)</li>
            </ol>
            <p><em>Note: The Powershell script runs separately from the SharpCap Eclipse Sequencer script. Ending the SharpCap Eclipse Sequencer script will not terminate the Powershell script.</em></p>
            <p><em>However, the Powershell script will terminate on its own about 5 seconds after the final scheduled audiable alert.</em></p>
        </div>
        <table id="wrapperTable"><tr style="vertical-align: top;"><td>
            <table class="params">
                <tr><th colspan="2" class="headerBlock">Eclipse Times</th></tr>

                <tr><td class="label">(C1) Partial Begins:</td><td><input onChange="verifyTime(this);" onKeyUp="verifyTime(this);" id="partial_begins" type="text"></td></tr>
                <tr><td class="label">(C2) Full Begins:</td><td><input onChange="verifyTime(this);" onKeyUp="verifyTime(this);" id='full_begins' type="text"></td></tr>
                <tr><td class="label">(C3) Full Ends:</td><td><input onChange="verifyTime(this);" onKeyUp="verifyTime(this);" id='full_ends' type="text"></td></tr>
                <tr><td class="label">(C4) Partial Ends:</td><td><input onChange="verifyTime(this);" onKeyUp="verifyTime(this);" id="partial_ends" type="text"></td></tr>
            </table></td><td>
                <table class="params" id="phaseInterval">
                    <th colspan="2" class="headerBlock">Collection Timing</th>
                    <tr><td class="label">Partial Eclipse Count:</td><td>
                        <select id='partialCount' onChange="checkVisible('partialCount');">
                            <option value="0">Disabled</option>
                            <option value="5">5 times</option>
                            <option value="10" selected="selected">10 times</option>
                            <option value="20">20 times</option>
                            <option value="40">40 times</option>
                            <option value="50">50 times</option>
                            <option value="100">100 times</option>
                        </select> before and after
                    </td></tr>
                    <tr><td class="label">Partial Eclipse Interval:</td><td>
                        <select id='partialInterval' onChange="checkVisible('partialInterval');">
                            <option value="0">Disabled</option>
                            <option value="30">every 30 seconds</option>
                            <option value="60">every 1 minute</option>
                            <option value="120">every 2 minutes</option>
                            <option value="180">every 3 minutes</option>
                            <option value="240">every 4 minutes</option>
                            <option value="300">every 5 minutes</option>
                            <option value="360">every 6 minutes</option>
                            <option value="420">every 7 minutes</option>
                            <option value="480">every 8 minutes</option>
                            <option value="540">every 9 minutes</option>
                            <option value="600">every 10 minute</option>
                        </select>
                    </td></tr>
                    <tr><td class="label">Baily's Beads Capture Offset:</td><td>
                        <select id='bailysInterval' onChange="checkVisible('bailysInterval');">
                            <option value="0">Disabled</option>
                            <option value="6">+/- 6 seconds</option>
                            <option value="8">+/- 8 seconds</option>
                            <option value="10">+/- 10 seconds</option>
                            <option value="20">+/- 20 seconds</option>
                            <option value="30" selected="selected">+/- 30 seconds</option>
                            <option value="45">+/- 45 seconds</option>
                            <option value="60">+/- 60 seconds</option>
                        </select><input type='hidden' id='totalityInterval' value='1'/>
                    </td></tr>
                </table>
            </td><td>
            <table class="params">
                <th colspan="2" class="headerBlock">Camera Settings</th>
                <tr><td class="label">Camera Gain:</td><td><input onChange="hideOutput();" type="number" id="gain" value="26" min="0"/></td></tr>
                <tr><td class="label">Camera Offset:</td><td><input onChange="hideOutput();" type="number" id="offset" value="70" min="0"/></td></tr>
                <tr><td class="label">Output Format:</td><td>
                    <select id="output" onChange="hideOutput();">
                        <option value="SER file (*.ser)">SER</option>
                        <option value="PNG files (*.png)">PNG</option>
                        <option value="FITS files (*.fits)">FITS</option>
                        <option value="TIFF files (*.tif)">TIFF</option>
                        <option value="ADV files (*.adv)">ADV</option>
                    </select></td></tr>
                <tr><td class="label">SharpCap Profile<br />(blank for none):</td><td><input onChange="hideOutput();" type="text" id="profile" value="" /></td></tr>
            </table>
        </th></tr></table>
        <div class="planDiv" id="partialPlanDiv"><h3 class="headerBlock">Partial Phase Collection Plan :: repeat <span id="partialPlanHeader"></span> before and after Totality.</h3><table class="planTable" id="partialPlan"></table><input type='button' class="wideButton" value="Add Partial Plan Row" onClick='addPlanLine("partialPlan")' /></div>
        <div class="planDiv" id="bailysPlanDiv"><h3 class="headerBlock">Baily's Beads Collection Plan :: repeat every <input id="bailysDelay" onChange="hideOutput();" type="number" value="0" min="0"/> seconds for <span id="bailysPlanHeader"></span> on either side of Totality.</h3><table class="planTable" id="bailysPlan"></table><input type='button' class="wideButton" value="Add Bailys Plan Row" onClick='addPlanLine("bailysPlan")' /></div>
        <div class="planDiv" id="totalityPlanDiv"><h3 class="headerBlock">Totality Collection Plan :: repeat every <input id="totalityDelay" onChange="hideOutput();" type="number" value="0" min="0"/> seconds during Totality.</h3><table class="planTable" id="totalityPlan"></table><input type='button' class="wideButton" value="Add Totality Plan Row" onClick='addPlanLine("totalityPlan")' /></div>
        <input type="button" style="max-width: 45%; margin: 30px auto; padding: 30px;" value="Generate Sequence" id="generateButton" onClick="generateSharpCap();"/>

        <div id="generatePSConfigDiv" style="max-width: 45%; margin: 0 auto 30px; flex-direction: row;">
            <table class="params">
                <tr><th colspan="2" class="headerBlock">Powershell Script Config</th></tr>
                <tr>
                    <td class="label"><label for="generatePSConfig">Generate Powershell Script Config</label></td>
                    <td>
                        <select id="generatePSConfig" onChange="checkPSConfigOptions();">
                            <option value="Yes" selected="selected">Yes</option>
                            <option value="No">No</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="label"><label for="psConfigOptionNotifications">Display Windows Notifications</label></td>
                    <td>
                        <select id="psConfigOptionNotifications" class="psConfigOption" onChange="hideOutput();">
                            <option value="Yes" selected="selected">Yes</option>
                            <option value="No">No</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td class="label"><label for="psConfigOptionSoundType">Sound Type</label></td>
                    <td>
                        <select id="psConfigOptionSoundType" class="psConfigOption" onChange="hideOutput();">
                            <option value="TTS" selected="selected">Text-to-Speech (TTS)</option>
                            <option value="WAV">WAV Files</option>
                        </select>
                    </td>
                </tr>
            </table>


        </div>

        <div class="planDiv" id="sequenceDiv" style="display: none;">
            <h3 class="headerBlock">Generated Sequence</h3>
            <input type="button" value="Copy Sequence to Clipboard" id="clipboardButton" style="margin: 15px 15px 0 15px; max-width: 45%;" onClick="copyToClipboard();" /><input type="button" value="Download SharpCap Sequence" id="downloadButton" style="max-width: 45%;" onClick="downloadSequence();" />
            <textarea id="SharpCapSequence" style="width: 98%; height: 200px; margin: 10px auto; display: block;" readonly="readonly"
            placeholder="SharpCap sequence will appear here."></textarea>
        </div>
        <div class="psPlanDiv" id="psConfigDiv" style="display: none;">
            <h3 class="headerBlock">Generated Powershell Script Config</h3>
            <input type="button" value="Copy Powershell Script Config to Clipboard" id="psClipboardButton" style="margin: 15px 15px 0 15px; max-width: 45%;" onClick="copyPSToClipboard();" /><input type="button" value="Download Powershell Script Config" id="psDownloadConfigButton" style="margin: 15px 15px 0 0; max-width: 45%;" onClick="downloadPSScriptConfig();" /><input type="button" value="Download Powershell Script & Assets" id="psDownloadButton2" style="margin: 15px 15px 0 0; max-width: 45%; float: right;" onClick="downloadPSScript();" />
            <textarea id="PSScriptConfig" style="width: 98%; height: 200px; margin: 10px auto; display: block;" readonly="readonly"
                      placeholder="Powershell script config will appear here."></textarea>
        </div>
    </div>
    <script type="text/javascript">
        function uuidv4() {
            return "10000000-1000-4000-8000-100000000000".replace(/[018]/g, c =>
                (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)
            );
        }

        function ucFirst(word) {
            return word.charAt(0).toUpperCase() + word.slice(1);
        }

        function toggleDiv(t) {
            let divs=document.querySelectorAll('[id^="FlipDiv"]');
            let menus=document.querySelectorAll('[id^="Menu"]');
            if(t.classList.contains("active")) {
                divs.forEach(async (d) => {
                    d.style.display = "none";
                });
                menus.forEach(async (m) => { 
                    m.classList.remove("active");
                });
                return;
            }
            divs.forEach(async (d) => {
                if(d.id!="FlipDiv"+t.innerHTML) {
                    d.style.display = "none";
                }
            });
            menus.forEach(async (m) => { 
                if(m.id!="Menu"+t.innerHTML) {
                    m.classList.remove("active");
                }
            });
            t.classList.add("active");
            document.getElementById("FlipDiv"+t.innerHTML).style.display = "block";
        }

        function checkVisible(t) {
            let pmap = { "partialCount": "partialInterval", "partialInterval": "partialCount" };
            let e = document.getElementById(t);
            t = t.replace(/[A-Z].*$/,"");
            try {
                if(e.value==0) {
                    if(t.match("partial")) {
                        let pi=document.getElementById("partialInterval").value;
                        let pc=document.getElementById("partialCount").value;
                        if(pi==0 && pc==0) {
                            document.getElementById(t+"PlanDiv").style.display="none";
                            document.getElementById( t + 'psPlanDiv' ).style.display = 'none';
                            document.getElementById("partial_begins").classList.remove("goodInput");
                            document.getElementById("partial_begins").classList.remove("badInput");
                            document.getElementById("partial_begins").classList.add("disabledInput");
                            document.getElementById("partial_begins").readonly="readonly";
                            document.getElementById("partial_ends").classList.remove("goodInput");
                            document.getElementById("partial_ends").classList.remove("badInput");
                            document.getElementById("partial_ends").classList.add("disabledInput");
                            document.getElementById("partial_ends").readonly="readonly";
                        } else {
                            document.getElementById(t+"PlanDiv").style.display="block";
                            document.getElementById( t + 'psPlanDiv' ).style.display = 'block';
                            document.getElementById(t+"PlanHeader").innerHTML = e.options[e.selectedIndex].innerHTML;
                            if(document.getElementById(t+"Plan").rows.length==0)
                                addPlanLine(t+"Plan");
                            document.getElementById("partial_begins").removeAttribute('readonly');
                            document.getElementById("partial_ends").removeAttribute('readonly');
                            verifyTime(document.getElementById("partial_begins"));
                            verifyTime(document.getElementById("partial_ends"));
                        }
                    } else {
                        document.getElementById(t+"PlanDiv").style.display="none";
                        document.getElementById( t + 'psPlanDiv' ).style.display = 'none';
                    }
                } else {
                    var phPost = "";
                    if(t.match("partial"))
                        document.getElementById(pmap[e.id]).value = 0;
                    document.getElementById(t+"PlanDiv").style.display="block";
                    document.getElementById( t + 'psPlanDiv' ).style.display = 'block';
                    document.getElementById(t+"PlanHeader").innerHTML = e.options[e.selectedIndex].innerHTML + phPost;
                    if(document.getElementById(t+"Plan").rows.length==0)
                        addPlanLine(t+"Plan");
                    if(t=="partial") {
                        document.getElementById("partial_begins").removeAttribute('readonly');
                        document.getElementById("partial_ends").removeAttribute('readonly');
                        verifyTime(document.getElementById("partial_begins"));
                        verifyTime(document.getElementById("partial_ends"));
                    }
                }
            } catch(err) {
                console.log("Err: "+t+" :: "+err);
            }
            hideOutput();
        }

        function hideOutput() {
            document.getElementById("sequenceDiv").style.display = "none";
            document.getElementById( 'psConfigDiv' ).style.display = 'none';
            saveState();
        }

        function verifyTime(t) {
            hideOutput();
            let v=/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])$/.test(t.value);
            if(v) {
                t.classList.add("goodInput");
                t.classList.remove("badInput");
                t.classList.remove("disabledInput");
                saveState();
            } else {
                t.classList.remove("goodInput");
                t.classList.add("badInput");
                t.classList.remove("disabledInput");
            }
        }

        function checkIfLastStep(t) {
            let tbl = document.getElementById(t);
            if(tbl.rows.length==1)
                tbl.rows[0].cells[4].style.display="none";
            else
                tbl.rows[0].cells[4].style.display="block";
                hideOutput();
        }

        function addPlanLine(t) {
            let rowID = uuidv4();
            let tbl = document.getElementById(t);
            let rows = tbl.rows.length;
            let row = tbl.insertRow(tbl.rows.length);
            var cells = [];
            for(var i=0; i<5; i++)
                cells.push(row.insertCell(i));
            cells[0].innerHTML = "<input type='hidden' name='uuid' value='"+rowID+"' /><span name='step'>Step "+(rows+1).toString()+"</span>";
            cells[0].style.fontWeight = "bold";
            cells[0].style.textAlign = "center";
            cells[1].innerHTML = "Capture <input type='number' id='"+rowID+"count' value='1' min='1' onChange='hideOutput();' /><select onChange='hideOutput();' id='"+rowID+"type'><option value='frames' selected='selected'>frames</option><option value='seconds'>seconds</option></select>";
            cells[2].innerHTML = "at Exposure: <input type='number' id='"+rowID+"exposure' value='0.01' min='0' onChange='hideOutput();' /> sec";
            cells[3].innerHTML = "at Resolution: <input type='text' id='"+rowID+"resolution' value='' onChange='hideOutput();' /> pixels (blank = no change)";
            cells[4].innerHTML = "<input type='button' value='Delete Step' onClick='removeRow(this)' />"
            checkIfLastStep(t);
        }

        function removeRow(t) {
            let p = t.parentNode.parentNode;
            let tbl = document.getElementById(p.parentNode.parentNode.id);
            if(tbl.rows.length==1) {
                alert("Collection Plan needs at least one step.  Cannot delete the last step.");
                return;
            }
            p.parentNode.removeChild(p);

            for(var i=0;i<tbl.rows.length;i++) {
                tbl.rows[0].cells[0].childNodes[1].innerHTML = "Step "+(i+1).toString();
            }
            checkIfLastStep(tbl.id);
        }

        function format02d(v) {
            return(("00"+v.toString()).substr(-2))
        }

        function timeToSeconds(tm) {
            let tp = tm.split(":");
            var secs = parseInt(tp[2]);
            secs += parseInt(tp[1])*60;
            secs += parseInt(tp[0])*3600;
            return secs;
        }

        function secondsToTime(secs) {
            let h = Math.floor(secs/3600);
            secs -= h*3600;
            let m = Math.floor(secs/60);
            secs -= m*60;
            return(format02d(h)+":"+format02d(m)+":"+format02d(secs))
        }

        function generateSharpCap() {
            var now = new Date(),
                preOutput = [
                "SEQUENCE",
                "    # Generated by: ",
                "    # linuxkidd's SharpCap Eclipse Sequencer",
                "    # "+(window.location.href+"#"+dumpParams(hashMode=1)).replace(/##/g,"#")+";plans="+JSON.stringify(dumpPlans()),
                "    #",
                "    # Generated at: ",
                "    # "+now.toDateString()+" "+now.toTimeString(),
                "    #",
                "    #",
                "    # (C1) Partial begins: "+document.getElementById("partial_begins").value,
                "    # (C2) Full begins:    "+document.getElementById("full_begins").value,
                "    # (C3) Full ends:      "+document.getElementById("full_ends").value,
                "    # (C4) Partial ends:   "+document.getElementById("partial_ends").value,
                "    #"
                ],
                SharpCapSequenceEl = document.getElementById( 'SharpCapSequence' ),
                generatePSConfigEl = document.getElementById( 'generatePSConfig' );

            ["bailysInterval","partialCount","partialInterval","gain","offset","output", "profile"].forEach((a) => {
                preOutput.push("    # "+a+": "+document.getElementById(a).value);
            });
            preOutput.push("    #","    #");
            var output = new Array();
            var indent = 4;
            let partialInterval = parseInt(document.getElementById("partialInterval").value);
            let partialCount = parseInt(document.getElementById("partialCount").value);
            let bailysInterval = parseInt(document.getElementById("bailysInterval").value);
            let totalityDuration = timeToSeconds(document.getElementById("full_ends").value) - timeToSeconds(document.getElementById("full_begins").value);
            var preInterval = partialInterval;
            var postInterval = partialInterval;
            if(partialCount>0) {
                let preDuration = timeToSeconds(document.getElementById("full_begins").value) - timeToSeconds(document.getElementById("partial_begins").value) - bailysInterval - 120;
                let postDuration = timeToSeconds(document.getElementById("partial_ends").value) - timeToSeconds(document.getElementById("full_ends").value) - bailysInterval - 120;
                preInterval = preDuration / partialCount;
                postInterval = postDuration / partialCount;
            }

            try {
                if(partialInterval>0 || partialCount>0) {
                    ["partial_begins", "partial_ends"].forEach((t) => {
                        let v = /^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])$/.test(document.getElementById(t).value);
                        if(document.getElementById(t).value=="" || !v) {
                            alert("  Sorry, please fill in the "+t.split("_").join(" ")+" timestamp\n    in 24 hour, HH:MM:SS format.");
                            throw BreakException;
                        }
                    });
                }
                ["full_begins", "full_ends"].forEach((t) => {
                    let v = /^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(:[0-5][0-9])$/.test(document.getElementById(t).value);
                    if(document.getElementById(t).value=="" || !v) {
                        alert("  Sorry, please fill in the "+t.split("_").join(" ")+" timestamp\n    in 24 hour, HH:MM:SS format.");
                        throw BreakException;
                    }
                });
            } catch(e) {
                return;
            }

            hideOutput();

            ["partialInterval", "partialCount", "bailysInterval", "totalityInterval"].forEach((p) => {
                let e = document.getElementById(p);
                if(e.value!=0) {
                    p = p.replace(/[A-Z].*$/,"");
                    output.push(' '.repeat(indent)+"DEF SUB "+p+"Collection");
                    indent+=4;
                    preOutput.push("    # "+"#".repeat(36),"    # "+p+"Collection Plan","    # "+"#".repeat(36));
                    let t = document.getElementById(p+"Plan");
                    var lastRes = "";
                    var rowPseudo = "";
                    for( var row=0; row<t.rows.length; row++ ) {
                        let rowID = t.rows[row].cells[0].childNodes[0].value;
                        rowPseudo = "Step: "+(row+1).toString()+" - Capture "+document.getElementById(rowID+"count").value+" "+document.getElementById(rowID+"type").value;
                        rowPseudo += " at Exposure "+document.getElementById(rowID+"exposure").value + " seconds";
                        output.push(' '.repeat(indent)+"SET EXPOSURE TO "+document.getElementById(rowID+"exposure").value);
                        if(document.getElementById(rowID+"resolution").value!="" && document.getElementById(rowID+"resolution").value!=lastRes) {
                            output.push(' '.repeat(indent)+"SET RESOLUTION TO "+document.getElementById(rowID+"resolution").value);
                            rowPseudo += " at Resollution "+document.getElementById(rowID+"resolution").value;
                        }
                        var secVerb = "";
                        if(document.getElementById(rowID+"type").value=="seconds")
                            secVerb = " SECONDS ";

                        var delaySecs = Math.min(document.getElementById(rowID+"exposure").value * 5,2);
                        output.push(' '.repeat(indent)+"DELAY "+delaySecs.toString());
                        preOutput.push("    # Wait for "+delaySecs.toString()+" seconds");
                        output.push(' '.repeat(indent)+"CAPTURE "+document.getElementById(rowID+"count").value+secVerb+" LIVE FRAMES");
                        lastRes=document.getElementById(rowID+"resolution").value;
                        preOutput.push("    # "+rowPseudo);
                    }
                    preOutput.push("    #","    #");
                    indent-=4;
                    output.push(' '.repeat(indent)+"END SUB")
                    output.push("");
                }
            });

            function addWaitSub(title,startTime,offsetTime) {
                output.push(' '.repeat(indent)+"DEF SUB waitFor"+title)
                indent+=4;
                let st = secondsToTime(timeToSeconds(startTime)+offsetTime);
                output.push(' '.repeat(indent)+"WAIT UNTIL LATER THAN LOCALTIME "+st);
                indent-=4;
                output.push(' '.repeat(indent)+"END SUB")
                output.push("");
            }

            function addCollection(subRoutine,endTime,duration) {
                output.push(' '.repeat(indent)+"STOP AT LOCALTIME "+endTime);
                indent+=4;
                output.push(' '.repeat(indent)+"LOOP UNTIL LATER THAN LOCALTIME "+endTime);
                indent+=4;
                if(duration>0) {
                    output.push(' '.repeat(indent)+"PAD DURATION TO "+duration.toString());
                    indent+=4;
                }
                output.push(' '.repeat(indent)+"GOSUB "+subRoutine);

                if(duration>0) {
                    indent-=4;
                    output.push(' '.repeat(indent)+"END PAD DURATION");
                }
                indent-=4;
                output.push(' '.repeat(indent)+"END LOOP");
                indent-=4;
                output.push(' '.repeat(indent)+"END STOP AT");
            }

            var esOffset=0;
            if(partialInterval>0 || partialCount>0 ) {
                addWaitSub('PreEclipseStart',document.getElementById('partial_begins').value,-60);
                if(partialCount > 0)
                    esOffset=60;
                addWaitSub('EclipseStart',document.getElementById('partial_begins').value,esOffset);

                addWaitSub('PostTotalityPartialStart',document.getElementById('full_ends').value,bailysInterval + 60);
                addWaitSub('EclipseEnd',document.getElementById('partial_ends').value,esOffset * -1);
                addWaitSub('PostEclipseEnd',document.getElementById('partial_ends').value,60);
            }
            if(bailysInterval>0)
                addWaitSub('BailysOneStart',document.getElementById('full_begins').value,bailysInterval*-1);

            addWaitSub('TotalityStart',document.getElementById('full_begins').value,0);
            output.push("    PRESERVE CAMERA SETTINGS");
            output.push("        UNLOCK CONTROLS");
            output.push("");
            indent=12;

            output.push(' '.repeat(indent)+"LIVE MODE");
            output.push(' '.repeat(indent)+'ARRANGE FILES IN ONE FOLDER');
            output.push(' '.repeat(indent)+'TARGETNAME "PartialPreEclipse"');
            output.push(' '.repeat(indent)+"SET GAIN TO "+document.getElementById("gain").value);
            output.push(' '.repeat(indent)+"SET OFFSET to "+document.getElementById("offset").value);
            output.push(' '.repeat(indent)+'SET OUTPUT FORMAT TO "'+document.getElementById("output").value+'"');
            if(document.getElementById("profile").value!="") {
                preOutput.push("    # Load profile "+document.getElementById("profile").value);
                output.push(' '.repeat(indent)+"​LOAD PROFILE "+document.getElementById("profile").value);
            }

            output.push("");

            preOutput.push("    #","    # ## Begin Sequence","    #");
            var startTime = 0;
            var stopTime = 0;
            var esOffset = 0;
            /* 
             * BEGIN Partial @ C1 SEQUENCE
             */
            if(partialInterval>0 || partialCount>0) {
                if(partialCount > 0) {
                    esOffset = 60;
                    startTime = secondsToTime(timeToSeconds(document.getElementById('partial_begins').value) - esOffset);
                    preOutput.push("    # Wait until "+startTime);
                    preOutput.push("    # Capture one iteration of 'partialCollection'");

                    output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+startTime);
                    indent+=4;
                    output.push(' '.repeat(indent)+"GOSUB waitForPreEclipseStart");
                    output.push(' '.repeat(indent)+"GOSUB partialCollection");
                    indent-=4;
                    output.push(' '.repeat(indent)+"END IF");
                    output.push("")
                }
                startTime = secondsToTime(timeToSeconds(document.getElementById('partial_begins').value) + esOffset);
                stopTime = secondsToTime(timeToSeconds(document.getElementById('full_begins').value) - bailysInterval - 60); // Add in 60 second buffer before next step
                preOutput.push("    #","    # Wait until "+startTime);
                output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+stopTime);
                indent+=4;
                output.push(' '.repeat(indent)+"GOSUB waitForEclipseStart");
                preOutput.push("    # Collect 'partialCollection' every "+preInterval+" seconds, until "+stopTime);
                addCollection("partialCollection",stopTime,preInterval);
                indent-=4;
                output.push(' '.repeat(indent)+"END IF");
                output.push("");
            }
            /* 
             * BEGIN Baily's @ C2 SEQUENCE
             */
             if(bailysInterval>0) {
                startTime = secondsToTime(timeToSeconds(document.getElementById('full_begins').value)-bailysInterval);
                stopTime = document.getElementById('full_begins').value;
                preOutput.push("    #","    # Wait until "+startTime);
                output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+stopTime);
                indent+=4;
                output.push(' '.repeat(indent)+"GOSUB waitForBailysOneStart");
                output.push(' '.repeat(indent)+'TARGETNAME "BailysBeadsPreEclipse"');
                output.push(' '.repeat(indent)+"PLAY SOUND Alert");
                output.push(' '.repeat(indent)+'SHOW NOTIFICATION "Remove the Solar Filter!" COLOUR Green DURATION '+(totalityDuration+bailysInterval).toString());
                preOutput.push("    # Collect 'bailysCollection' every "+document.getElementById("bailysDelay").value+" seconds, until "+document.getElementById('full_begins').value);
                addCollection("bailysCollection",document.getElementById('full_begins').value,document.getElementById("bailysDelay").value);
                indent-=4;
                output.push(' '.repeat(indent)+"END IF");
                output.push("");
            }
            /* 
             * BEGIN Totality @ C2 SEQUENCE
             */
            stopTime = document.getElementById("full_ends").value;
            output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+stopTime);
            indent+=4;
            preOutput.push("    #","    # Wait until "+document.getElementById('full_begins').value);
            output.push(' '.repeat(indent)+"GOSUB waitForTotalityStart");
            if(partialInterval==0 && partialCount==0 && bailysInterval==0) {
                output.push(' '.repeat(indent)+"PLAY SOUND Alert");
                output.push(' '.repeat(indent)+'SHOW NOTIFICATION "Remove the Solar Filter!" COLOUR Green DURATION '+totalityDuration.toString());
            }
            output.push(' '.repeat(indent)+'TARGETNAME "FullEclipse"');
            preOutput.push("    # Collect 'totalityCollection' every "+document.getElementById("totalityDelay").value+" seconds, until "+document.getElementById('full_ends').value);
            addCollection("totalityCollection",document.getElementById("full_ends").value,document.getElementById("totalityDelay").value);
            indent-=4;
            output.push(' '.repeat(indent)+"END IF");
            output.push("");
            /* 
             * BEGIN Baily's @ C3 SEQUENCE
             */
            if(bailysInterval>0) {
                stopTime = secondsToTime(timeToSeconds(document.getElementById('full_ends').value)+bailysInterval);
                output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+stopTime);
                indent+=4;
                preOutput.push("    #","    # Collect 'bailysCollection' every "+document.getElementById("bailysDelay").value+" seconds, until "+secondsToTime(timeToSeconds(document.getElementById('full_ends').value)+bailysInterval));
                output.push(' '.repeat(indent)+'TARGETNAME "BailysBeadsPostEclipse"');
                addCollection("bailysCollection",stopTime,document.getElementById("bailysDelay").value);
                indent-=4;
                output.push(' '.repeat(indent)+"END IF");
                output.push("");
            }

            output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME "+secondsToTime(timeToSeconds(document.getElementById('full_ends').value) + bailysInterval));
            indent+=4;
            output.push(' '.repeat(indent)+"PLAY SOUND Error");
            output.push(' '.repeat(indent)+'SHOW NOTIFICATION "URGENT!   Apply the Solar Filter!   URGNET!" COLOUR Red DURATION 120');
            indent-=4;
            output.push(' '.repeat(indent)+"END IF");
            output.push("");

            /* 
             * BEGIN Partial @ C3 SEQUENCE
             */
             if(partialInterval>0 || partialCount>0) {
                startTime = secondsToTime(timeToSeconds(document.getElementById('full_ends').value) + bailysInterval + 60);
                stopTime = secondsToTime(timeToSeconds(document.getElementById('partial_ends').value) - esOffset);
                preOutput.push("    #","    # Wait until " + startTime);
                output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME " + stopTime);
                indent+=4;
                output.push(' '.repeat(indent)+'GOSUB waitForPostTotalityPartialStart');
                output.push(' '.repeat(indent)+'TARGETNAME "PartialPostEclipse"');
                preOutput.push("    # Collect 'partialCollection' every " + postInterval + " seconds, until " + stopTime);
                addCollection("partialCollection",stopTime,postInterval);
                indent-=4;
                output.push(' '.repeat(indent)+"END IF");
                output.push("");

                if(partialCount > 0) {
                    esOffset = 60;
                    startTime = secondsToTime(timeToSeconds(document.getElementById('partial_ends').value) + esOffset);
                    stopTime = secondsToTime(timeToSeconds(document.getElementById('partial_ends').value) + esOffset);
                    preOutput.push("    #","    # Wait until " + startTime);
                    preOutput.push("    # Capture one iteration of 'partialCollection'");
                    output.push(' '.repeat(indent)+"IF EARLIER THAN LOCALTIME " + stopTime);
                    indent+=4;
                    output.push(' '.repeat(indent)+"GOSUB waitForPostEclipseEnd");
                    output.push(' '.repeat(indent)+"GOSUB partialCollection");
                    indent-=4;
                    output.push(' '.repeat(indent)+"END IF");
                    output.push("")
                }
            }
            output.push(' '.repeat(indent)+"PLAY SOUND Alert");
            output.push(' '.repeat(indent)+'SHOW NOTIFICATION "Solar Eclipse Collection is complete!" COLOUR Green DURATION 120');

            output.push("        END UNLOCK");
            output.push("    END PRESERVE");
            output.push("END SEQUENCE");
            preOutput.push("    #","    # ## End Sequence","    #","    #");

            if ( generatePSConfigEl.value === 'Yes' ) {
                preOutput.push( "", "    # Powershell Script", "    RUN PowerShell WITH PARAMS \"-NoProfile -ExecutionPolicy Bypass -WindowStyle Hidden -Command \\\" & '.\\scripts\\eclipse\\april-2024-solar-eclipse.ps1'\\\"\" WAIT False" );

                generatePSConfig();
            }

            SharpCapSequenceEl.value = preOutput.join("\n") + "\n\n" + output.join("\n");

            // Start a new thread
            setTimeout( function() {
                SharpCapSequenceEl.scrollTop = 0;
            }, 1 );

            document.getElementById("sequenceDiv").style.display = "block";

            window.scrollTo(0, document.body.scrollHeight);
        }


        function checkPSConfigOptions() {
            let generatePSConfigEl = document.getElementById( 'generatePSConfig' ),
                shouldGeneratePSConfig = ( generatePSConfigEl.value === 'Yes' ),
                disablePSConfigOptionEls = ( ! shouldGeneratePSConfig ),
                psConfigOptionEls = document.querySelectorAll( '.psConfigOption' );

            psConfigOptionEls.forEach( async function( el ) {
                el.disabled = ( disablePSConfigOptionEls );

                if ( disablePSConfigOptionEls ) {
                    el.setAttribute( 'disabled', ( ! shouldGeneratePSConfig ) ? 'disabled' : '' );
                }
                else {
                    el.removeAttribute( 'disabled' );
                }
            } );


            hideOutput();
        }

        function generatePSConfig() {
            let PSScriptConfigEl = document.getElementById( 'PSScriptConfig' ),
                psConfigOptionNotificationsEl = document.getElementById( 'psConfigOptionNotifications' ),
                displayWindowsNotifications = ( psConfigOptionNotificationsEl.value === 'Yes' ) ? '$true' : '$false',
                psConfigOptionSoundTypeEl = document.getElementById( 'psConfigOptionSoundType' ),
                useTTS = ( psConfigOptionSoundTypeEl.value === 'TTS' ) ? '$true' : '$false',
                config_output = [
                    "#################",
                    "# Configuration #",
                    "#################"
                ];

            // Global
            config_output.push( "" );
            config_output.push( "##" );
            config_output.push( "# Global" );
            config_output.push( "#" );
            config_output.push( "" );

            // Windows Notifications
            config_output.push( "# Windows Notifications" );
            config_output.push( "$display_windows_notifications = " + displayWindowsNotifications );
            config_output.push( "" );

            // Use TTS
            config_output.push( "# TTS" );
            config_output.push( "$use_tts = " + useTTS );
            config_output.push( "" );


            // Sounds, Text-to-Speech (TTS), and Notifications
            config_output.push( "" );
            config_output.push( "##" );
            config_output.push( "# Sounds, Text-to-Speech (TTS), and Notifications" );
            config_output.push( "#" );
            config_output.push( "" );

            // Initialize
            config_output.push( "# Initialize" );
            config_output.push( "$initialize_sound_path = '.\\scripts\\eclipse\\sounds\\00-Initialized.wav'" );
            config_output.push( "$initialize_tts_text = 'The SharpCap eclipse script has been initialized and is waiting to start'" );
            config_output.push( "$initialize_notification_title = 'SharpCap Script - Initialized'" );
            config_output.push( "$initialize_notification_text = 'The SharpCap eclipse script is waiting to start'" );
            config_output.push( "$initialize_notification_type = 'Info'" );
            config_output.push( "" );

            // Script Start
            config_output.push( "# Script Start" );
            config_output.push( "$script_start_sound_path = '.\\scripts\\eclipse\\sounds\\01-Eclipse-Start.wav'" );
            config_output.push( "$script_start_tts_text = 'The SharpCap eclipse script has started'" );
            config_output.push( "$script_start_notification_title = 'SharpCap Script - Started'" );
            config_output.push( "$script_start_notification_text = 'The SharpCap eclipse script has started'" );
            config_output.push( "$script_start_notification_type = 'Info'" );
            config_output.push( "" );

            // C1 - 60 Seconds Prior
            config_output.push( "# C1 - 60 Seconds Prior" );
            config_output.push( "$c1_sixty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\02-First-Contact-60-Seconds.wav'" );
            config_output.push( "$c1_sixty_seconds_prior_alert_tts_text = 'First contact is in 60 seconds'" );
            config_output.push( "$c1_sixty_seconds_prior_alert_notification_title = 'First Contact In 60 Seconds'" );
            config_output.push( "$c1_sixty_seconds_prior_alert_notification_text = 'First contact is in 60 seconds'" );
            config_output.push( "$c1_sixty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C1 - 30 Seconds Prior
            config_output.push( "# C1 - 30 Seconds Prior" );
            config_output.push( "$c1_thirty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-30-Seconds.wav'" );
            config_output.push( "$c1_thirty_seconds_prior_alert_tts_text = '30 seconds'" );
            config_output.push( "$c1_thirty_seconds_prior_alert_notification_title = 'First Contact In 30 Seconds'" );
            config_output.push( "$c1_thirty_seconds_prior_alert_notification_text = 'First contact is in 30 seconds'" );
            config_output.push( "$c1_thirty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C1 - 20 Seconds Prior
            config_output.push( "# C1 - 20 Seconds Prior" );
            config_output.push( "$c1_twenty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-20-Seconds.wav'" );
            config_output.push( "$c1_twenty_seconds_prior_alert_tts_text = '20 seconds'" );
            config_output.push( "$c1_twenty_seconds_prior_alert_notification_title = 'First Contact In 20 Seconds'" );
            config_output.push( "$c1_twenty_seconds_prior_alert_notification_text = 'First contact is in 20 seconds'" );
            config_output.push( "$c1_twenty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C1 - 10 Seconds Prior
            config_output.push( "# C1 - 10 Seconds Prior" );
            config_output.push( "$c1_ten_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-10-Seconds.wav'" );
            config_output.push( "$c1_ten_seconds_prior_alert_tts_text = '10 seconds'" );
            config_output.push( "$c1_ten_seconds_prior_alert_notification_title = 'First Contact In 10 Seconds'" );
            config_output.push( "$c1_ten_seconds_prior_alert_notification_text = 'First contact is in 10 seconds'" );
            config_output.push( "$c1_ten_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C1
            config_output.push( "# C1" );
            config_output.push( "$c1_alert_sound_path = '.\\scripts\\eclipse\\sounds\\03-First-Contact-Now.wav'" );
            config_output.push( "$c1_alert_tts_text = 'First contact is happening now'" );
            config_output.push( "$c1_alert_notification_title = 'First Contact Now'" );
            config_output.push( "$c1_alert_notification_text = 'First contact is happening now'" );
            config_output.push( "$c1_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C2 - Telescope Refocus
            config_output.push( "# C2 - Telescope Refocus" );
            config_output.push( "$c2_telescope_refocus_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Refocus-Telescope.wav'" );
            config_output.push( "$c2_telescope_refocus_alert_tts_text = 'Refocus telescope if necessary'" );
            config_output.push( "$c2_telescope_refocus_alert_notification_title = 'Refocus Telescope'" );
            config_output.push( "$c2_telescope_refocus_alert_notification_text = 'Refocus telescope if necessary'" );
            config_output.push( "$c2_telescope_refocus_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C2 - Venus 20 Minutes Prior
            config_output.push( "# C2 - Venus 20 Minutes Prior" );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus.wav'" );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_tts_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_notification_title = 'Look for Venus'" );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_notification_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - Venus 10 Minutes Prior
            config_output.push( "# C2 - Venus 10 Minutes Prior" );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus.wav'" );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_tts_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_notification_title = 'Look for Venus'" );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_notification_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - Venus 5 Minutes Prior
            config_output.push( "# C2 - Venus 5 Minutes Prior" );
            config_output.push( "$c2_venus_five_minutes_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus.wav'" );
            config_output.push( "$c2_venus_five_minutes_prior_alert_tts_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_five_minutes_prior_alert_notification_title = 'Look for Venus'" );
            config_output.push( "$c2_venus_five_minutes_prior_alert_notification_text = 'Look for Venus at about 5 o''clock in relation to the sun'" );
            config_output.push( "$c2_venus_five_minutes_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - 3 Minutes Prior
            config_output.push( "# C2 - 3 Minutes Prior" );
            config_output.push( "$c2_three_minutes_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\04-Second-Contact-3-Minutes.wav'" );
            config_output.push( "$c2_three_minutes_prior_alert_tts_text = 'Second contact is in 3 minutes'" );
            config_output.push( "$c2_three_minutes_prior_alert_notification_title = 'Second Contact In 3 Minutes'" );
            config_output.push( "$c2_three_minutes_prior_alert_notification_text = 'Second contact is in 3 minutes'" );
            config_output.push( "$c2_three_minutes_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - 2 Minutes Prior
            config_output.push( "# C2 - 2 Minutes Prior" );
            config_output.push( "$c2_two_minutes_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\05-Second-Contact-2-Minutes.wav'" );
            config_output.push( "$c2_two_minutes_prior_alert_tts_text = 'Second contact is in 2 minutes'" );
            config_output.push( "$c2_two_minutes_prior_alert_notification_title = 'Second Contact In 2 Minutes'" );
            config_output.push( "$c2_two_minutes_prior_alert_notification_text = 'Second contact is in 2 minutes'" );
            config_output.push( "$c2_two_minutes_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - Jupiter 90 Seconds Prior
            config_output.push( "# C2 - Jupiter 90 Seconds Prior" );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Jupiter.wav'" );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_tts_text = 'Look for Jupiter at about 11 o''clock in relation to the sun'" );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_notification_title = 'Look for Jupiter'" );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_notification_text = 'Look for Jupiter at about 11 o''clock in relation to the sun'" );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - 60 Seconds Prior
            config_output.push( "# C2 - 60 Seconds Prior" );
            config_output.push( "$c2_sixty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\06-Second-Contact-60-Seconds.wav'" );
            config_output.push( "$c2_sixty_seconds_prior_alert_tts_text = 'Second contact is in 60 seconds'" );
            config_output.push( "$c2_sixty_seconds_prior_alert_notification_title = 'Second Contact In 60 Seconds'" );
            config_output.push( "$c2_sixty_seconds_prior_alert_notification_text = 'Second contact is in 60 seconds'" );
            config_output.push( "$c2_sixty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - Remove Solar Filter
            config_output.push( "# C2 - Remove Solar Filter" );
            config_output.push( "$c2_remove_solar_filter_alert_sound_path = '.\\scripts\\eclipse\\sounds\\07-Remove-Solar-Filter.wav'" );
            config_output.push( "$c2_remove_solar_filter_alert_tts_text = 'Remove solar filter'" );
            config_output.push( "$c2_remove_solar_filter_alert_notification_title = 'Remove Solar Filter'" );
            config_output.push( "$c2_remove_solar_filter_alert_notification_text = 'Remove solar filter'" );
            config_output.push( "$c2_remove_solar_filter_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C2 - 30 Seconds Prior
            config_output.push( "# C2 - 30 Seconds Prior" );
            config_output.push( "$c2_thirty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-30-Seconds.wav'" );
            config_output.push( "$c2_thirty_seconds_prior_alert_tts_text = '30 seconds'" );
            config_output.push( "$c2_thirty_seconds_prior_alert_notification_title = 'Second Contact In 30 Seconds'" );
            config_output.push( "$c2_thirty_seconds_prior_alert_notification_text = 'Second contact is in 30 seconds'" );
            config_output.push( "$c2_thirty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - 20 Seconds Prior
            config_output.push( "# C2 - 20 Seconds Prior" );
            config_output.push( "$c2_twenty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-20-Seconds.wav'" );
            config_output.push( "$c2_twenty_seconds_prior_alert_tts_text = '20 seconds'" );
            config_output.push( "$c2_twenty_seconds_prior_alert_notification_title = 'Second Contact In 20 Seconds'" );
            config_output.push( "$c2_twenty_seconds_prior_alert_notification_text = 'Second contact is in 20 seconds'" );
            config_output.push( "$c2_twenty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - 10 Seconds Prior
            config_output.push( "# C2 - 10 Seconds Prior" );
            config_output.push( "$c2_ten_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-10-Seconds.wav'" );
            config_output.push( "$c2_ten_seconds_prior_alert_tts_text = '10 seconds'" );
            config_output.push( "$c2_ten_seconds_prior_alert_notification_title = 'Second Contact In 10 Seconds'" );
            config_output.push( "$c2_ten_seconds_prior_alert_notification_text = 'Second contact is in 10 seconds'" );
            config_output.push( "$c2_ten_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C2 - Diamond Ring
            config_output.push( "# C2 - Diamond Ring" );
            config_output.push( "$c2_diamond_ring_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Diamond-Ring.wav'" );
            config_output.push( "$c2_diamond_ring_alert_tts_text = 'Look for diamond ring'" );
            config_output.push( "$c2_diamond_ring_alert_notification_title = 'Look For Diamond Ring'" );
            config_output.push( "$c2_diamond_ring_alert_notification_text = 'Look for Diamond Ring'" );
            config_output.push( "$c2_diamond_ring_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C2 - Baily's Beads
            config_output.push( "# C2 - Baily's Beads" );
            config_output.push( "$c2_bailys_beads_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Bailys-Beads.wav'" );
            config_output.push( "$c2_bailys_beads_alert_tts_text = 'Look for Baily''s Beads'" );
            config_output.push( "$c2_bailys_beads_alert_notification_title = 'Look For Baily''s Beads'" );
            config_output.push( "$c2_bailys_beads_alert_notification_text = 'Look for Baily''s Beads'" );
            config_output.push( "$c2_bailys_beads_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C2
            config_output.push( "# C2" );
            config_output.push( "$c2_alert_sound_path = '.\\scripts\\eclipse\\sounds\\08-Second-Contact-Now.wav'" );
            config_output.push( "$c2_alert_tts_text = 'Second contact is happening now'" );
            config_output.push( "$c2_alert_notification_title = 'Second Contact Now'" );
            config_output.push( "$c2_alert_notification_text = 'Second contact is happening now'" );
            config_output.push( "$c2_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // Totality Start
            config_output.push( "# Totality Start" );
            config_output.push( "$totality_start_alert_sound_path = '.\\scripts\\eclipse\\sounds\\09-Totality-Now.wav'" );
            config_output.push( "$totality_start_alert_tts_text = 'Totality is happening now'" );
            config_output.push( "$totality_start_alert_notification_title = 'Totality Now'" );
            config_output.push( "$totality_start_alert_notification_text = 'Totality is happening now'" );
            config_output.push( "$totality_start_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // Totality - First Observe Horizon
            config_output.push( "# Totality - First Observe Horizon" );
            config_output.push( "$totality_first_observe_horizon_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Observe-Horizon.wav'" );
            config_output.push( "$totality_first_observe_horizon_alert_tts_text = 'Observe the horizon'" );
            config_output.push( "$totality_first_observe_horizon_alert_notification_title = 'Observe The Horizon'" );
            config_output.push( "$totality_first_observe_horizon_alert_notification_text = 'Observe the horizon'" );
            config_output.push( "$totality_first_observe_horizon_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // Totality - Pons Brooks
            config_output.push( "# Totality - Pons Brooks" );
            config_output.push( "$totality_pons_brooks_alert_sound_path = '.\\scripts\\eclipse\\sounds\\10-Pons-Brooks.wav'" );
            config_output.push( "$totality_pons_brooks_alert_tts_text = 'Look for comet 12P (Pons-Brooks) near Jupiter at about 4 o''clock in relation to Jupiter. This comet will appear between Jupiter and the Sun if visible.'" );
            config_output.push( "$totality_pons_brooks_alert_notification_title = 'Comet 12P (Pons-Brooks)'" );
            config_output.push( "$totality_pons_brooks_alert_notification_text = 'Look for Comet 12P (Pons-Brooks) near Jupiter at about 4 o''clock in relation to Jupiter. This comet will appear between Jupiter and the Sun if visible.'" );
            config_output.push( "$totality_pons_brooks_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // Totality - Maximum Eclipse
            config_output.push( "# Totality - Maximum Eclipse" );
            config_output.push( "$totality_maximum_eclipse_alert_sound_path = '.\\scripts\\eclipse\\sounds\\11-Maximum-Eclipse-Now.wav'" );
            config_output.push( "$totality_maximum_eclipse_alert_tts_text = 'Maximum eclipse is happening now'" );
            config_output.push( "$totality_maximum_eclipse_alert_notification_title = 'Maximum Eclipse Now'" );
            config_output.push( "$totality_maximum_eclipse_alert_notification_text = 'Maximum eclipse is happening now'" );
            config_output.push( "$totality_maximum_eclipse_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // Totality - Second Observe Horizon
            config_output.push( "# Totality - Second Observe Horizon" );
            config_output.push( "$totality_second_observe_horizon_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Observe-Horizon.wav'" );
            config_output.push( "$totality_second_observe_horizon_alert_tts_text = 'Observe the horizon'" );
            config_output.push( "$totality_second_observe_horizon_alert_notification_title = 'Observe The Horizon'" );
            config_output.push( "$totality_second_observe_horizon_alert_notification_text = 'Observe the horizon'" );
            config_output.push( "$totality_second_observe_horizon_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - 60 Seconds Prior
            config_output.push( "# C3 - 60 Seconds Prior" );
            config_output.push( "$c3_sixty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\12-Third-Contact-60-Seconds.wav'" );
            config_output.push( "$c3_sixty_seconds_prior_alert_tts_text = 'Third contact is in 60 seconds'" );
            config_output.push( "$c3_sixty_seconds_prior_alert_notification_title = 'Third Contact In 60 Seconds'" );
            config_output.push( "$c3_sixty_seconds_prior_alert_notification_text = 'Third contact is in 60 seconds'" );
            config_output.push( "$c3_sixty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - 30 Seconds Prior
            config_output.push( "# C3 - 30 Seconds Prior" );
            config_output.push( "$c3_thirty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-30-Seconds.wav'" );
            config_output.push( "$c3_thirty_seconds_prior_alert_tts_text = '30 seconds'" );
            config_output.push( "$c3_thirty_seconds_prior_alert_notification_title = 'Third Contact In 30 Seconds'" );
            config_output.push( "$c3_thirty_seconds_prior_alert_notification_text = 'Third contact is in 30 seconds'" );
            config_output.push( "$c3_thirty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - 20 Seconds Prior
            config_output.push( "# C3 - 20 Seconds Prior" );
            config_output.push( "$c3_twenty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-20-Seconds.wav'" );
            config_output.push( "$c3_twenty_seconds_prior_alert_tts_text = '20 seconds'" );
            config_output.push( "$c3_twenty_seconds_prior_alert_notification_title = 'Third Contact In 20 Seconds'" );
            config_output.push( "$c3_twenty_seconds_prior_alert_notification_text = 'Third contact is in 20 seconds'" );
            config_output.push( "$c3_twenty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - 10 Seconds Prior
            config_output.push( "# C3 - 10 Seconds Prior" );
            config_output.push( "$c3_ten_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-10-Seconds.wav'" );
            config_output.push( "$c3_ten_seconds_prior_alert_tts_text = '10 seconds'" );
            config_output.push( "$c3_ten_seconds_prior_alert_notification_title = 'Third Contact In 10 Seconds'" );
            config_output.push( "$c3_ten_seconds_prior_alert_notification_text = 'Third contact is in 10 seconds'" );
            config_output.push( "$c3_ten_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // Totality End
            config_output.push( "# Totality End" );
            config_output.push( "$totality_end_alert_sound_path = '.\\scripts\\eclipse\\sounds\\13-Totality-Ending-Now.wav'" );
            config_output.push( "$totality_end_alert_tts_text = 'Totality is ending now'" );
            config_output.push( "$totality_end_alert_notification_title = 'Totality Ending'" );
            config_output.push( "$totality_end_alert_notification_text = 'Totality is ending now'" );
            config_output.push( "$totality_end_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C3
            config_output.push( "# C3" );
            config_output.push( "$c3_alert_sound_path = '.\\scripts\\eclipse\\sounds\\14-Third-Contact-Now.wav'" );
            config_output.push( "$c3_alert_tts_text = 'Third contact is happening now'" );
            config_output.push( "$c3_alert_notification_title = 'Third Contact Now'" );
            config_output.push( "$c3_alert_notification_text = 'Third contact is happening now'" );
            config_output.push( "$c3_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C3 - Baily's Beads
            config_output.push( "# C3 - Baily's Beads" );
            config_output.push( "$c3_bailys_beads_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Bailys-Beads.wav'" );
            config_output.push( "$c3_bailys_beads_alert_tts_text = 'Look for Baily''s Beads'" );
            config_output.push( "$c3_bailys_beads_alert_notification_title = 'Look For Baily''s Beads'" );
            config_output.push( "$c3_bailys_beads_alert_notification_text = 'Look for Baily''s Beads'" );
            config_output.push( "$c3_bailys_beads_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C3 - Diamond Ring
            config_output.push( "# C3 - Diamond Ring" );
            config_output.push( "$c3_diamond_ring_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Diamond-Ring.wav'" );
            config_output.push( "$c3_diamond_ring_alert_tts_text = 'Look for diamond ring'" );
            config_output.push( "$c3_diamond_ring_alert_notification_title = 'Look For Diamond Ring'" );
            config_output.push( "$c3_diamond_ring_alert_notification_text = 'Look for Diamond Ring'" );
            config_output.push( "$c3_diamond_ring_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C3 - Replace Solar Filter
            config_output.push( "# C3 - Replace Solar Filter" );
            config_output.push( "$c3_replace_solar_filter_alert_sound_path = '.\\scripts\\eclipse\\sounds\\15-Replace-Solar-Filter.wav'" );
            config_output.push( "$c3_replace_solar_filter_alert_tts_text = 'Replace solar filter'" );
            config_output.push( "$c3_replace_solar_filter_alert_notification_title = 'Replace Solar Filter'" );
            config_output.push( "$c3_replace_solar_filter_alert_notification_text = 'Replace solar filter'" );
            config_output.push( "$c3_replace_solar_filter_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C3 - Jupiter 60 Seconds After
            config_output.push( "# C3 - Jupiter 60 Seconds After" );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Jupiter-Disappear.wav'" );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_tts_text = 'Jupiter should disappear shortly'" );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_notification_title = 'Jupiter Disappearing'" );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_notification_text = 'Jupiter should disappear shortly'" );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - Venus 5 Minutes After
            config_output.push( "# C3 - Venus 5 Minutes After" );
            config_output.push( "$c3_venus_five_minutes_after_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus-Disappear.wav'" );
            config_output.push( "$c3_venus_five_minutes_after_alert_tts_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_five_minutes_after_alert_notification_title = 'Venus Disappearing'" );
            config_output.push( "$c3_venus_five_minutes_after_alert_notification_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_five_minutes_after_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - Venus 10 Minutes After
            config_output.push( "# C3 - Venus 10 Minutes After" );
            config_output.push( "$c3_venus_ten_minutes_after_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus-Disappear.wav'" );
            config_output.push( "$c3_venus_ten_minutes_after_alert_tts_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_ten_minutes_after_alert_notification_title = 'Venus Disappearing'" );
            config_output.push( "$c3_venus_ten_minutes_after_alert_notification_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_ten_minutes_after_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - Venus 20 Minutes After
            config_output.push( "# C3 - Venus 20 Minutes After" );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Venus-Disappear.wav'" );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_tts_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_notification_title = 'Venus Disappearing'" );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_notification_text = 'Venus should disappear shortly'" );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C3 - Telescope Refocus
            config_output.push( "# C3 - Telescope Refocus" );
            config_output.push( "$c3_telescope_refocus_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-Refocus-Telescope.wav'" );
            config_output.push( "$c3_telescope_refocus_alert_tts_text = 'Refocus telescope if necessary'" );
            config_output.push( "$c3_telescope_refocus_alert_notification_title = 'Refocus Telescope'" );
            config_output.push( "$c3_telescope_refocus_alert_notification_text = 'Refocus telescope if necessary'" );
            config_output.push( "$c3_telescope_refocus_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // C4 - 60 Seconds Prior
            config_output.push( "# C4 - 60 Seconds Prior" );
            config_output.push( "$c4_sixty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\16-Fourth-Contact-60-Seconds.wav'" );
            config_output.push( "$c4_sixty_seconds_prior_alert_tts_text = 'Fourth contact is in 60 seconds'" );
            config_output.push( "$c4_sixty_seconds_prior_alert_notification_title = 'Fourth Contact In 60 Seconds'" );
            config_output.push( "$c4_sixty_seconds_prior_alert_notification_text = 'Fourth contact is in 60 seconds'" );
            config_output.push( "$c4_sixty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C4 - 30 Seconds Prior
            config_output.push( "# C4 - 30 Seconds Prior" );
            config_output.push( "$c4_thirty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-30-Seconds.wav'" );
            config_output.push( "$c4_thirty_seconds_prior_alert_tts_text = '30 seconds'" );
            config_output.push( "$c4_thirty_seconds_prior_alert_notification_title = 'Fourth Contact In 30 Seconds'" );
            config_output.push( "$c4_thirty_seconds_prior_alert_notification_text = 'Fourth contact is in 30 seconds'" );
            config_output.push( "$c4_thirty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C4 - 20 Seconds Prior
            config_output.push( "# C4 - 20 Seconds Prior" );
            config_output.push( "$c4_twenty_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-20-Seconds.wav'" );
            config_output.push( "$c4_twenty_seconds_prior_alert_tts_text = '20 seconds'" );
            config_output.push( "$c4_twenty_seconds_prior_alert_notification_title = 'Fourth Contact In 20 Seconds'" );
            config_output.push( "$c4_twenty_seconds_prior_alert_notification_text = 'Fourth contact is in 20 seconds'" );
            config_output.push( "$c4_twenty_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C4 - 10 Seconds Prior
            config_output.push( "# C4 - 10 Seconds Prior" );
            config_output.push( "$c4_ten_seconds_prior_alert_sound_path = '.\\scripts\\eclipse\\sounds\\00-10-Seconds.wav'" );
            config_output.push( "$c4_ten_seconds_prior_alert_tts_text = '10 seconds'" );
            config_output.push( "$c4_ten_seconds_prior_alert_notification_title = 'Fourth Contact In 10 Seconds'" );
            config_output.push( "$c4_ten_seconds_prior_alert_notification_text = 'Fourth contact is in 10 seconds'" );
            config_output.push( "$c4_ten_seconds_prior_alert_notification_type = 'Info'" );
            config_output.push( "" );

            // C4
            config_output.push( "# C4" );
            config_output.push( "$c4_alert_sound_path = '.\\scripts\\eclipse\\sounds\\17-Fourth-Contact-Now.wav'" );
            config_output.push( "$c4_alert_tts_text = 'Fourth contact is happening now'" );
            config_output.push( "$c4_alert_notification_title = 'Fourth Contact Now'" );
            config_output.push( "$c4_alert_notification_text = 'Fourth contact is happening now'" );
            config_output.push( "$c4_alert_notification_type = 'Warning'" );
            config_output.push( "" );

            // Script End
            config_output.push( "" );
            config_output.push( "# Script End" );
            config_output.push( "$script_end_sound_path = '.\\scripts\\eclipse\\sounds\\18-Eclipse-End.wav'" );
            config_output.push( "$script_end_tts_text = 'The SharpCap eclipse script has ended'" );
            config_output.push( "$script_end_notification_title = 'SharpCap Script - Ended'" );
            config_output.push( "$script_end_notification_text = 'The SharpCap eclipse script has ended'" );
            config_output.push( "$script_end_notification_type = 'Info'" );
            config_output.push( "" );


            // Timestamps
            config_output.push( "" );
            config_output.push( "##" );
            config_output.push( "# Timestamps" );
            config_output.push( "#" );
            config_output.push( "# Note: Local device times" );
            config_output.push( "#" );
            config_output.push( "" );

            // Script Start
            config_output.push( "# Script Start" );
            config_output.push( "$script_start_time = '" + secondsToTime( timeToSeconds( document.getElementById( 'partial_begins' ).value ) - 65 ) + "'" );
            config_output.push( "" );

            // C1
            let c1_alert_time_seconds = timeToSeconds( document.getElementById( 'partial_begins' ).value ),
                c1_alert_time = secondsToTime( c1_alert_time_seconds );
            config_output.push( "" );
            config_output.push( "# C1 - " + c1_alert_time );
            config_output.push( "$c1_alert_time = '" + c1_alert_time + "'" );
            config_output.push( "$c1_sixty_seconds_prior_alert_time = ( Get-Date $c1_alert_time ).AddSeconds( -60 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c1_alert_time_seconds - 60 ) );
            config_output.push( "$c1_thirty_seconds_prior_alert_time = ( Get-Date $c1_alert_time ).AddSeconds( -30 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c1_alert_time_seconds - 30 ) );
            config_output.push( "$c1_twenty_seconds_prior_alert_time = ( Get-Date $c1_alert_time ).AddSeconds( -20 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c1_alert_time_seconds - 20 ) );
            config_output.push( "$c1_ten_seconds_prior_alert_time = ( Get-Date $c1_alert_time ).AddSeconds( -10 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c1_alert_time_seconds - 10 ) );

            config_output.push( "" );

            // C2
            let c2_alert_time_seconds = timeToSeconds( document.getElementById( 'full_begins' ).value ),
                c2_alert_time = secondsToTime( c2_alert_time_seconds );
            config_output.push( "" );
            config_output.push( "# C2 - " + c2_alert_time );
            config_output.push( "$c2_alert_time = '" + c2_alert_time + "'" );
            config_output.push( "$c2_telescope_refocus_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -1500 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 1500 ) );
            config_output.push( "$c2_venus_twenty_minutes_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -1200 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 1200 ) );
            config_output.push( "$c2_venus_ten_minutes_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -600 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 600 ) );
            config_output.push( "$c2_venus_five_minutes_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -300 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 300 ) );
            config_output.push( "$c2_three_minutes_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -180 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 180 ) );
            config_output.push( "$c2_two_minutes_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -120 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 120 ) );
            config_output.push( "$c2_jupiter_ninety_seconds_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -90 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 90 ) );
            config_output.push( "$c2_sixty_seconds_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -60 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 60 ) );
            config_output.push( "$c2_remove_solar_filter_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -33 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 32 ) );
            config_output.push( "$c2_thirty_seconds_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -30 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 30 ) );
            config_output.push( "$c2_twenty_seconds_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -20 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 20 ) );
            config_output.push( "$c2_ten_seconds_prior_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -10 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 10 ) );
            config_output.push( "$c2_diamond_ring_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -8 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 8 ) );
            config_output.push( "$c2_bailys_beads_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( -5 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds - 5 ) );
            config_output.push( "" );

            // Totality
            let c3_alert_time_seconds = timeToSeconds( document.getElementById( 'full_ends' ).value ),
                c3_alert_time = secondsToTime( c3_alert_time_seconds ),
                totality_end_time_offset = ( c3_alert_time_seconds - c2_alert_time_seconds ),
                maximum_eclipse_time = parseInt( ( ( c3_alert_time_seconds - c2_alert_time_seconds ) / 2 ), 10 );
            config_output.push( "" );
            config_output.push( "# Totality - " + c2_alert_time + " - " + c3_alert_time );
            config_output.push( "$totality_start_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( 4 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds + 4 ) );
            config_output.push( "$totality_first_observe_horizon_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( 20 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds + 20 ) );
            config_output.push( "$totality_pons_brooks_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( 50 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds + 50 ) );
            config_output.push( "$totality_maximum_eclipse_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( " + maximum_eclipse_time + " ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds + maximum_eclipse_time ) );
            config_output.push( "$totality_second_observe_horizon_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( 80 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c2_alert_time_seconds + 80 ) );
            config_output.push( "" );

            // C3
            config_output.push( "" );
            config_output.push( "# C3 - " + c3_alert_time );
            config_output.push( "$c3_alert_time = '" + c3_alert_time + "'" );
            config_output.push( "$c3_sixty_seconds_prior_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( -60 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds - 60 ) );
            config_output.push( "$c3_thirty_seconds_prior_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( -30 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds - 30 ) );
            config_output.push( "$c3_twenty_seconds_prior_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( -20 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds - 20 ) );
            config_output.push( "$c3_ten_seconds_prior_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( -10 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds - 10 ) );
            config_output.push( "$totality_end_alert_time = ( Get-Date $c2_alert_time ).AddSeconds( " + ( totality_end_time_offset - 4 ) + " ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds - 4 ) );
            config_output.push( "$c3_bailys_beads_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 3 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 3 ) );
            config_output.push( "$c3_diamond_ring_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 6 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 6 ) );
            config_output.push( "$c3_replace_solar_filter_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 32 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 32 ) );
            config_output.push( "$c3_jupiter_sixty_seconds_after_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 60 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 60 ) );
            config_output.push( "$c3_venus_five_minutes_after_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 300 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 300 ) );
            config_output.push( "$c3_venus_ten_minutes_after_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 600 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 600 ) );
            config_output.push( "$c3_venus_twenty_minutes_after_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 1200 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 1200 ) );
            config_output.push( "$c3_telescope_refocus_alert_time = ( Get-Date $c3_alert_time ).AddSeconds( 1500 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c3_alert_time_seconds + 1500 ) );

            config_output.push( "" );

            // C4
            let c4_alert_time_seconds = timeToSeconds( document.getElementById( 'partial_ends' ).value ),
                c4_alert_time = secondsToTime( c4_alert_time_seconds );
            config_output.push( "" );
            config_output.push( "# C4 - " + c4_alert_time );
            config_output.push( "$c4_alert_time = '" + c4_alert_time + "'" );
            config_output.push( "$c4_sixty_seconds_prior_alert_time = ( Get-Date $c4_alert_time ).AddSeconds( -60 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c4_alert_time_seconds - 60 ) );
            config_output.push( "$c4_thirty_seconds_prior_alert_time = ( Get-Date $c4_alert_time ).AddSeconds( -30 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c4_alert_time_seconds - 30 ) );
            config_output.push( "$c4_twenty_seconds_prior_alert_time = ( Get-Date $c4_alert_time ).AddSeconds( -20 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c4_alert_time_seconds - 20 ) );
            config_output.push( "$c4_ten_seconds_prior_alert_time = ( Get-Date $c4_alert_time ).AddSeconds( -10 ).ToString( 'HH:mm:ss' ) # " + secondsToTime( c4_alert_time_seconds - 10 ) );
            config_output.push( "" );

            // Script End
            config_output.push( "" );
            config_output.push( "# Script End" );
            config_output.push( "$script_end_time = '" + secondsToTime( timeToSeconds( document.getElementById( 'partial_ends' ).value ) + 15 ) + "'" );

            PSScriptConfigEl.value = config_output.join( "\n" );

            // Start a new thread
            setTimeout( function() {
                PSScriptConfigEl.scrollTop = 0;
            }, 1 );

            document.getElementById( 'psConfigDiv' ).style.display = 'block';
        }

        function copyToClipboard() {
            navigator.clipboard.writeText(document.getElementById("SharpCapSequence").value);
        }

        function copyPSToClipboard() {
            navigator.clipboard.writeText( document.getElementById( 'PSScriptConfig' ).value );
        }

        function downloadSequence() {
            var textToSave = document.getElementById("SharpCapSequence").value;
            var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
            var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
            var fileNameToSaveAs = "SharpCap_Eclipse_Sequence.scs";

            var downloadLink = document.createElement("a");
            downloadLink.download = fileNameToSaveAs;
            downloadLink.innerHTML = "Download File";
            downloadLink.href = textToSaveAsURL;
            downloadLink.onclick = destroyClickedElement;
            downloadLink.style.display = "none";
            document.body.appendChild(downloadLink);

            downloadLink.click();
        }

        function downloadPSScript() {
            var fileNameToSaveAs = 'april-2024-solar-eclipse-powershell-script.zip';

            var downloadLink = document.createElement( 'a' );
            downloadLink.download = fileNameToSaveAs;
            downloadLink.innerHTML = 'Download File';
            downloadLink.href = 'scripts/powershell/april-2024-solar-eclipse-powershell-script.zip';
            downloadLink.onclick = destroyClickedElement;
            downloadLink.style.display = 'none';
            document.body.appendChild( downloadLink );

            downloadLink.click();
        }

        function downloadPSScriptConfig() {
            var textToSave = document.getElementById("PSScriptConfig").value;
            var textToSaveAsBlob = new Blob([textToSave], {type:"text/plain"});
            var textToSaveAsURL = window.URL.createObjectURL(textToSaveAsBlob);
            var fileNameToSaveAs = 'april-2024-solar-eclipse-config.ps1';

            var downloadLink = document.createElement("a");
            downloadLink.download = fileNameToSaveAs;
            downloadLink.innerHTML = "Download File";
            downloadLink.href = textToSaveAsURL;
            downloadLink.onclick = destroyClickedElement;
            downloadLink.style.display = "none";
            document.body.appendChild(downloadLink);

            downloadLink.click();
        }

        function destroyClickedElement(event) {
            document.body.removeChild(event.target);
        }


        function parseSavedParams(params) {
            for( const [k,v] of Object.entries(params) ) {
                try {
                    document.getElementById(k).value = v;
                } catch(e) {
                    // pass;
                }
            }
        }


        function parseSavedPlans(plans) {
            for( const [p,rows] of Object.entries(plans) ) {
                let t = document.getElementById(p+"Plan");
                if(t) {
                    for(var r = t.rows.length; r<rows.length; r++)
                        addPlanLine(p+"Plan");

                    for(var row=0; row<rows.length; row++) {
                        let rowID = t.rows[row].cells[0].childNodes[0].value;
                        document.getElementById(rowID+"count").value    = rows[row][0];
                        document.getElementById(rowID+"type").value     = rows[row][1];
                        document.getElementById(rowID+"exposure").value = rows[row][2];
                        if(rows[row].length==4)
                            document.getElementById(rowID+"resolution").value = rows[row][3];
                    }
                }
            }
        }

        function readURL() {
            let kvs = window.location.hash.replace("#","").split(";");
            kvs.forEach((a) => {
                if(a.length == 0)
                    return;
                let kv=decodeURI(a).split("=");
                if(kv[0]=="plans") {
                    parseSavedPlans(JSON.parse(kv[1]));
                } else {
                    try {
                        document.getElementById(kv[0]).value = kv[1];
                    } catch(e) {
                        // pass;
                    }
                }
            });
            window.location.hash='';
        }

        function dumpPlans() {
            var plans={};
            ["partialInterval", "partialCount", "bailysInterval", "totalityInterval"].forEach((p) => {
                let e = document.getElementById(p);
                if(e.value!=0) {
                    p = p.replace(/[A-Z].*$/,"");
                    plans[p]=new Array();
                    let t = document.getElementById(p+"Plan");
                    for( var row=0; row<t.rows.length; row++ ) {
                        let rowID = t.rows[row].cells[0].childNodes[0].value;
                        plans[p].push([
                            parseFloat(document.getElementById(rowID+"count").value),
                            document.getElementById(rowID+"type").value,
                            parseFloat(document.getElementById(rowID+"exposure").value)]);
                        if(document.getElementById(rowID+"resolution").value!="")
                            plans[p][plans[p].length - 1].push(document.getElementById(rowID+"resolution").value);
                    }
                }
            });
            return plans;
        }

        function dumpParams(hashMode=0) {
            if(hashMode)
                var params = [];
            else
                var params = {};

            ["partial_begins", "partial_ends","full_begins", "full_ends","bailysInterval","partialInterval", "partialCount","gain","offset","output","profile","bailysDelay","totalityDelay"].forEach((a) => {
                params[a]=document.getElementById(a).value;
                if(hashMode) {
                        params.push(a+'='+document.getElementById(a).value)
                } else {
                    if(document.getElementById(a).value.match(/^[0-9\.\-]+$/))
                        params[a]=parseFloat(document.getElementById(a).value);
                    else
                        params[a]=document.getElementById(a).value;
                }
            });
            if(hashMode)
                return params.join(";");
            return params;
        }

        function saveState() {
            window.localStorage.setItem("params",JSON.stringify(dumpParams()));
            window.localStorage.setItem( "plans",JSON.stringify(dumpPlans()));
        }

        function loadState() {
            let ls=window.localStorage;
            if(ls.hasOwnProperty('params'))
                parseSavedParams(JSON.parse(ls.getItem('params')));
            if(ls.hasOwnProperty('plans'))
                parseSavedPlans(JSON.parse(ls.getItem('plans')));
        }

        readURL();
        loadState();

        if(document.getElementById("totalityPlan").rows.length==0)
            addPlanLine("totalityPlan");
        checkVisible("partialInterval");
        checkVisible("partialCount");
        checkVisible("bailysInterval");
        setTimeout(function() {["partial_begins","full_begins","full_ends","partial_ends"].forEach((t) => verifyTime(document.getElementById(t)));},500);
        
    </script>
</body>
 
</html>